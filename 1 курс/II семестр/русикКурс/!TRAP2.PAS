PROGRAM kurs_tr;
USES CRT,TrapInt;
VAR
  a,b:real;    { Границы отрезка }
  b1,b2:real;  { Вспомогательные переменные}
  e:real;      { Точность }
  r,r2:real;   { Предыдущее и текущее приближенные значения интеграла }
  n:integer;   { Количество отрезков }
BEGIN
  ClrScr;
  a:=1;
  { Ввод границ поиска }
  WriteLn('Введите границы поиска:');
  ReadLn(b1,b2);
  WriteLn('Введите точность:');
  ReadLn(e);
  repeat
    b:=(b1+b2)/2; { Проверяем середину отрезка}
    { Вычисляется интеграл по методу трапеций }
    n:=3;
    r:=trap(a,b,n);         { Начальное значение }
    repeat
      r2:=r;                { Запоминается предыдущее значение }
      n:=n+2;               { Увеличивается количество шагов }
      r:=trap(a,b,n);       { Рассчитывается новое значение }
    until (abs(r-r2)<e);{ Повторяется до достижения необходимой точности }
    if r>pi then b2:=b else b1:=b; { Уменьшение отрезка поиска}
  until ABS(pi-r)<e; { Повторяется до достижения необходимой точности }
  { Вывод результатов }
  WriteLn;
  WriteLn('R =',b:4:4);
  WriteLn('Результат по методу трапеций равен: ',r:4:4);
  WriteLn('для получения необходимой точности интервал был разбит на ');
  WriteLn(n,' отрезков');
  readkey;
END.
